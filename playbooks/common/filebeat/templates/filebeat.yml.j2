######################## Filebeat Configuration ##############################

#==========================  Modules configuration ===========================
filebeat.config.modules:
  path: ${path.config}/modules.d/*.yml

#=========================== Filebeat inputs =================================
filebeat.inputs:
- type: log
  enabled: true
  paths:
    - /var/log/monit.log
    - /var/log/filebeat/filebeat
    - /opt/railsapp/log/puma.stderr.log
    - /opt/railsapp/log/puma.stdout.log

- type: log
  enabled: true
  json.keys_under_root: true
  json.add_error_key: true
  paths:
    - /var/log/nginx/access.json
    - /opt/railsapp/log/production.json

#-------------------------- Elasticsearch output -------------------------------
output.elasticsearch:
  # Boolean flag to enable or disable the output module.
  enabled: true
  hosts: ["{{ groups['elk'][0] }}:9200"]
#  index: "logstash-%{+yyyy.MM.dd}"
#setup.template.name: "logstash"
#setup.template.pattern: "logstash-*"


#============================== Dashboards =====================================
#           # These settings control loading the sample dashboards to the Kibana index. 
setup.dashboards.enabled: true
#setup.dashboards.index: "logstash-*"
setup.dashboards.always_kibana: true
     
#============================== Kibana =====================================
#       # Starting with Beats version 6.0.0, the dashboards are loaded via the Kibana API.
#       # This requires a Kibana endpoint configuration.

setup.kibana:
   host: "{{ groups['elk'][0] }}:5601"

        # Use SSL settings for HTTPS. Default is true.

ssl.enabled: false

#================================ Logging ======================================
logging.to_files: true
logging.files:
  path: /var/log/filebeat
  name: filebeat
  rotateeverybytes: 10485760 # = 100MB
  keepfiles: 7
  permissions: 0600
